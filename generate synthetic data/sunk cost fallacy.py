import matplotlib.pyplot as plt
import matplotlib.patches as patches

# 创建绘图
fig, ax = plt.subplots(figsize=(14, 8))

# 设置标题和轴标签
ax.set_title('APT Attackers’ Behavior and Sunk Cost Fallacy', fontsize=16)
ax.set_xlabel('Time', fontsize=14)
ax.set_ylabel('Activity Level', fontsize=14)

# 绘制各个阶段的矩形区域
# APT攻击者初始行为：植入木马程序
ax.add_patch(patches.Rectangle((0, 7), 20, 3, edgecolor='black', facecolor='lightblue', label='Implant Trojan'))
ax.text(10, 8.5, 'Implant Trojan', horizontalalignment='center', verticalalignment='center', fontsize=12)

# 无法进一步渗透
ax.add_patch(patches.Rectangle((20, 5), 30, 2, edgecolor='black', facecolor='lightcoral', label='Failed to Penetrate Core Network'))
ax.text(35, 6, 'Failed to Penetrate Core Network', horizontalalignment='center', verticalalignment='center', fontsize=12)

# 目标组织增强安全措施
ax.add_patch(patches.Rectangle((50, 5), 20, 2, edgecolor='black', facecolor='lightgreen', label='Enhanced Security Measures'))
ax.text(60, 6, 'Enhanced Security Measures', horizontalalignment='center', verticalalignment='center', fontsize=12)

# APT攻击者继续使用木马程序
ax.add_patch(patches.Rectangle((70, 5), 30, 2, edgecolor='black', facecolor='orange', label='Continue Using Trojan'))
ax.text(85, 6, 'Continue Using Trojan', horizontalalignment='center', verticalalignment='center', fontsize=12)

# 绘制时间轴
plt.plot([0, 100], [5, 5], color='black')

# 标记时间点
time_points = [0, 20, 50, 70, 100]
time_labels = ['Start', 'Trojan Implanted', 'Failed Penetration', 'Security Enhanced', 'Continue Using']
for t, label in zip(time_points, time_labels):
    plt.text(t, 4.5, label, horizontalalignment='center', verticalalignment='center', fontsize=10)

# 设置图例
plt.legend(loc='upper right')

# 设置轴范围
ax.set_xlim(0, 100)
ax.set_ylim(0, 10)

# 显示图表
plt.show()
