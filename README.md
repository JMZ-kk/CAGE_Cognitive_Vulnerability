# CAGE_Cognitive_Vulnerability

In order to simulate the real environment, it is necessary to introduce some extensions to the environment. New actions including CrackFile, DiscoverFile, CheckCredFile, FileCreation are introduced to the CAGE Challenge 4 environment. Some modifications are also applied on ExploitRemoteService to give red agents more choice. New actions are listed below.

| Agent | Action | Description |
|-------|--------|-------------|
| Red | DiscoverFile | Find the paths, names and values of files in the host |
| Red | CrackFile | Crack a file by bruteforce or using password |
| Red | CheckCredFile | Check the reliability of the cred file |
| Blue | FileCreation | Create a file |

In CAGE Challenge 4, all red agents’ attack behaviors, like DegradeServices and Impact, are process-targeting. However, there are many file-targeting attack behaviors widely used in real life. For example, an attacker can get valuable messages from some important files. In CAGE Challenge 4, a file only has filename and path. In order to make the design closer to reality, value, hardness and password is introduced to each file. The details of these new attributes are listed below.

| Attribute | Description |
|------------|-------------|
| value | An integer representing the value of this file. Common file's value is between 1 and 100. Cred file's value is 200. |
| hardness | The probability of failure when a red agent tries to crack the file with bruteforce. It is determined by the complexity of the password. The hardness of a file without a password is 0. |
| password | Some files are password protected files. Regardless of the hardness of the file, the red agent has a 100% success rate if the password is known. |
| content | Some files, like cred files, have important information about other hosts in their content, like the filename-password mappings. Red agents can get some additional information to help themselves make decisions in future actions. |

A red agent needs to call DiscoverFile action to collect all the files’ filename, path and value in the target host. Files with positive value would be recorded by red agents. Then, the red agent can choose to take CrackFile action to crack the file with bruteforce. This action is modeled by generating a random number between 0 and 1. If this random number is bigger than the file’s hardness, this action succeeds; otherwise, it fails. A successful CrackFile action can give the red agent a reward equal to the value of this file. Then, a cracked file’s value would become 0 because the red agent can not get new information from this file. If a CrackFile action fails, the reward is 0.

The file’s content would also be added into the next step’s observation of this red agent after a successful CrackFile action. If it is a cred file, red agents can get passwords of some files in this subnet. However, some passwords are fake and some files do not exist. The red agent can choose to call CheckCredFile action to check the reliability of a cred file. This action has a high probability to filter fake password-filename mappings for red agents. When using the CrackFile action with a password, if the password is correct, the action will definitely succeed; otherwise, it will fail.
