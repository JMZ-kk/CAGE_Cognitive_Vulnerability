from CybORG.Shared.Enums import DecoyType
from CybORG.Simulator.Actions.ConcreteActions.DecoyActions.DecoyAction import DecoyAction
from CybORG.Simulator.Actions.AbstractActions.Misinform import DecoyFactory

class ApacheDecoyFactory(DecoyFactory):
    """
    Assembles process information to appear as an apache server
    """
    PORT = 80
    SERVICE_NAME = "apache3"
    NAME = "apache3"
    PROCESS_TYPE = "webserver"
    PROPERTIES = ["rfi"]
    PROCESS_PATH="/usr/sbin"


class MultipleDeployApache(DecoyAction):
    """
    Creates a misleading process on the designated host depending on
    available and compatible options.
    """
        
    DECOY_TYPE = DecoyType.EXPLOIT
    CANDIDATE_DECOYS = {ApacheDecoyFactory()}

    def __init__(self, *, session: int, agent: str, hostname: str,decoy_num: int):
        super().__init__(session=session, agent=agent, hostname=hostname)
        self.duration = 1
        self.decoy_num=decoy_num
