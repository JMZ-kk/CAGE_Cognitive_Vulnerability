from typing import Set
from CybORG.Shared.Enums import DecoyType
from CybORG.Shared.Observation import Observation
from CybORG.Shared.Session import Session
from CybORG.Simulator.Actions import Action
from CybORG.Simulator.Actions.AbstractActions.Misinform import Decoy, DecoyFactory
from CybORG.Simulator.Host import Host
from CybORG.Simulator.Process import Process
from CybORG.Simulator.Service import Service
from CybORG.Simulator.State import State


class UserCreation(Action):
    def __init__(self, username, hostname, password):
        super().__init__()
        self.hostname = hostname
        self.username=username
        self.password=password
        self.duration=1

    def execute(self, state: State) -> Observation:
        obs_succeed = Observation(True)
        state.add_user(host=self.hostname,username=self.username,password=self.password)
        return obs_succeed

    def __str__(self):
        return f"{self.__class__.__name__} {self.hostname}"
